@page
@model HomeService.Areas.Admin.Pages.Contracts.IndexModel
@{
}
<div class="page-content">
    <div class="container-fluid">

        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
               
                        <h2 class="card-header d-flex justify-content-between align-items-center">
                            @sharedResource["Contracts"]
                            <a asp-page="Add" class="btn btn-primary">@sharedResource["Add"]  @sharedResource["Contract"]  </a>
                        </h2>
                    </div>
                    <div class="card-body">


                        @(Html.DevExtreme().DataGrid<HomeService.Models.Contract>
    ()
    .DataSource(ds => ds.Mvc()
    .Controller("Contracts")
    .LoadAction("Get")
    .InsertAction("Post")
    .UpdateAction("Put")
    .DeleteAction("Delete")
    .Key("ContractId")


    )
    .RemoteOperations(true)
    .Columns(columns => {

        columns.AddFor(m => m.CustomerId).Lookup(lookup => lookup
        .DataSource(ds => ds.WebApi().Controller("Contracts").LoadAction("CustomerLookup").Key("Value"))
        .ValueExpr("Value")
        .DisplayExpr("Text")
        ).Caption(sharedResource["Customer"]);
        columns.AddFor(m => m.UnitId).Lookup(lookup => lookup
    .DataSource(ds => ds.WebApi().Controller("Contracts").LoadAction("UnitLookup").Key("Value"))
    .ValueExpr("Value")
    .DisplayExpr("Text")
    ).Caption(sharedResource["Unit"]);
        columns.AddFor(m => m.StartDate).Caption(sharedResource["StartDate"]).Width(200);
        columns.AddFor(m => m.EndDate).Caption(sharedResource["EndDate"]).Width(200);
        columns.AddFor(m => m.Amount).Caption(sharedResource["Amount"]).Width(200);
            columns.Add().Caption(sharedResource["Actions"]).Width(200).Alignment(HorizontalAlignment.Center).CellTemplate(@<text>

                        <div class="btn-group" role="group" aria-label="Basic example">
                        <a class="btn btn-primary btn-sm"  href="/Admin/Contracts/Details?id=<%- data.ContractId %>"> <i class="fas fa-eye"></i> </a>
                                <a class="btn btn-success btn-sm"  href="/Admin/Contracts/Edit?id=<%- data.ContractId %>">  <i class="fas fa-edit"></i> </a>
                               <a class="btn btn-danger btn-sm" href="/Admin/Contracts/Delete?id=<%- data.ContractId %>">  <i class="fas fa-trash"></i> </a>
                            </div>
                            </text>);

    }

    )

    .Editing(e => e.Mode(GridEditMode.Popup)
    .Texts(c => c
    .CancelRowChanges(sharedResource["Cancel"])
    .SaveRowChanges(sharedResource["Save"]).EditRow(sharedResource["Edit"])
    .DeleteRow(sharedResource["Delete"])
    .ConfirmDeleteMessage(sharedResource["ConfirmDeleteMessage"])
    .AddRow(sharedResource["Add"]))




    .Popup(p => p
    .Title(sharedResource["Contract"])
    .ShowTitle(true)
    .MaxWidth(750)
    .RtlEnabled(bool.Parse(sharedResource["ArLang"]))


    .Height(250)).Form(f => f.Items(items =>
    {
        items.AddGroup()
        .ColCount(2)
        .ColSpan(2)
        .Items(groupItems =>
        {
            groupItems.AddSimple().DataField("ContractTlAr").IsRequired(true);
            groupItems.AddSimple().DataField("ContractTlEn").IsRequired(true);
            groupItems.AddSimple().DataField("CityId").IsRequired(true);
        });



    }))

    )
    .Paging(paging => paging.PageSize(10))
    .Pager(pager =>
    {
        pager.Visible(true);
        pager.DisplayMode(GridPagerDisplayMode.Full);
        pager.ShowPageSizeSelector(true);
        pager.AllowedPageSizes(new JS("[5, 10, 'all']"));
        pager.ShowInfo(true);
        pager.ShowNavigationButtons(true);

    })
    .HeaderFilter(headerFilter => headerFilter.Visible(true)).ShowColumnLines(false)
    .ShowRowLines(true)
    .RowAlternationEnabled(true)
    .AllowColumnReordering(true)
    .ShowRowLines(true)
    .ShowColumnLines(true)
    .ShowBorders(true)
    .SearchPanel(searchPanel => searchPanel
    .Visible(true)
    .Width(240)
    .Placeholder(sharedResource["SearchTxt"]))
    .RemoteOperations(true)
    .RtlEnabled(bool.Parse(sharedResource["ArLang"]))
    )

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>